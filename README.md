# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack
Для сборки используется Webpack.

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```
или

```
yarn
yarn start
```

## Сборка

```
npm run build
```
или

```
yarn build
```
## Архитектура

Приложение организовано в соответствии с паттерном MVP, где данные, представление и презентер взаимодействуют между собой через событийно-ориентированный подход.

- Слой модели занимается работой с данными - их получением, обработкой и изменением.

- Слой представления отвечает за отображение данных и работу с интерфейсом приложения.

- Презентер (реализован в файле index.ts) соединяет модель и представление, обеспечивая эффективное взаимодействие между ними.

Основное взаимодействие в приложении начинается с index.ts, который выполняет поиск шаблонов разметки, создает экземпляры классов для работы с бэкендом и EventEmitter. EventEmitter реализует паттерн "наблюдатель", позволяя компонентам подписываться на события и реагировать на них.

Далее приложение, используя цепочку событий, обрабатывает действия пользователя на странице через EventEmitter, обеспечивая взаимодействие с различными компонентами интерфейса приложения - формами, модальными окнами, корзиной.

В случае успешного сценария использования, информация о карточках в корзине, контактных данных пользователя, платежной информации и общей стоимости заказа отправляется на сервер с помощью POST-запроса, обрабатываемого экземпляром класса IproductsAPI.

Это позволяет эффективно управлять состоянием приложения, обеспечивать плавное взаимодействие пользователя с интерфейсом и передавать необходимую информацию между компонентами приложения.

## Ключевые интерфейсы

обзор ключевых интерфейсов  из файла index.ts в папке types:

- IView<T>: Интерфейс для представления, предоставляющий методы для управления элементами интерфейса пользователя, такими как изменение класса, текста, состояния видимости и изображений, а также для отрисовки данных.
- IModel: Интерфейс модели, определяющий метод для передачи изменений событий.
- IProduct: Интерфейс продукта, описывающий свойства продукта, такие как идентификатор, описание, изображение, название, категория и цена.
- IFormState: Интерфейс состояния формы, содержащий флаг валидности и сообщение об ошибке.
- IForm: Интерфейс формы, расширяющий интерфейс состояния формы и предоставляющий метод для отрисовки формы.
- IContactForm: Интерфейс контактной формы, содержащий поля для адреса электронной почты и телефона.
- IIdentifier: Интерфейс идентификатора, определяющий только идентификатор.
- IOrderList: Интерфейс списка заказа, содержащий общую стоимость и список идентификаторов продуктов.
- IOrderResult: Интерфейс результата заказа, содержащий идентификатор заказа и общую стоимость.
- ICatalogCard: Тип карточки каталога, исключая описание продукта.
- IPreviewCard: Тип карточки предварительного просмотра, включающий свойства продукта, а также флаги валидности и состояния.
- IBasketCard: Тип карточки корзины, исключая описание, категорию и изображение продукта, а также включающий индекс.
PaymentMethod: Тип способа оплаты, который может быть "наличными" или "картой".
- IOrderFormData: Интерфейс данных формы заказа, включающий способ оплаты и адрес, а также контактные данные и список заказанных товаров.
- IOrderBuilder: Интерфейс построителя заказа, содержащий данные о доставке, контактной информации, списке заказа и результатах заказа.
- IProductsAPI: Интерфейс API продуктов, предоставляющий методы для получения информации о продуктах и оформления заказа.
- IInputData: Интерфейс ввода данных, содержащий имя поля и его значение.


## Базовый код

- Api: Класс для работы с низкоуровневыми операциями API. Он имеет методы для отправки GET и POST запросов на сервер, а также для обработки ответов.
- EventEmitter: Этот класс реализует паттерн "Наблюдатель" и позволяет подписываться на события и уведомлять подписчиков о наступлении событий.
- Model: Это базовый абстрактный класс для всех классов моделей данных. Он использует EventEmitter для уведомления о изменениях в данных.
- Component: Этот класс представляет базовый абстрактный класс для всех классов отображений в пользовательском интерфейсе. Он предоставляет методы для управления HTML-элементами и отображения данных.


## Компоненты модели данных:

- IProductApi: Этот компонент работает с API конкретного магазина. Он позволяет получить список товаров, конкретный товар или оформить заказ через сервис "Web ларёк". Методы класса позволяют выполнять запросы к API для получения данных о товарах и оформления заказа.
- Catalog: Класс, представляющий модель для коллекции товаров на главной странице. Он используется для хранения и обработки данных о товарах. Этот компонент содержит список товаров и методы для работы с ним, такие как установка и получение списка товаров, а также поиск конкретного товара по идентификатору.
Basket: Этот компонент представляет модель для корзины покупок. Он используется для хранения и обработки данных о товарах, добавленных в корзину. В корзину нельзя добавить два одинаковых товара. Класс содержит методы для добавления, удаления и очистки товаров в корзине, а также для получения общей стоимости и списка идентификаторов товаров.
- Order: Компонент, представляющий модель для заказа. Он используется для хранения и обработки данных о заказе, таких как способ оплаты, адрес доставки, контактная информация и список купленных товаров. Класс содержит методы для установки данных заказа и преобразования его в формат, пригодный для отправки на сервер.
- OrderBuilder: Этот компонент представляет собой билдер для заказа и реализует паттерн "builder". Он используется для поэтапного формирования заказа, позволяя устанавливать данные о доставке, контактную информацию и список товаров. После завершения формирования заказа, можно получить объект заказа для отправки на сервер.


## Компоненты представления:

- Modal: Компонент, ответственный за работу с модальным окном и его управление. Его конструктор принимает элемент DOM в качестве контейнера и объект для управления событиями. Внутри содержит кнопку закрытия и контент модального окна. Методы позволяют устанавливать контент, открывать и закрывать окно.

- Form: Этот компонент отображает формы пользовательского интерфейса и управляет ими. Он принимает в конструкторе элемент формы и объект для управления событиями. Компонент содержит свойства для хранения списка входных элементов формы, кнопки отправки и элемента для отображения ошибок. Методы позволяют проверять валидность формы, устанавливать ошибки, очищать форму и отображать ее на странице.

- Page: Этот компонент отвечает за общие элементы страницы, такие как кнопка корзины, список карточек и счетчик товаров в корзине. Его конструктор принимает элемент DOM в качестве контейнера и объект для управления событиями. Методы позволяют устанавливать список карточек, значение счетчика товаров и блокировать прокрутку страницы.

- Card: Базовый класс для всех карточек товаров. Он отвечает за отображение информации о товаре, такой как название, цена и изображение, и управляет этими данными. В конструкторе принимает элемент DOM в качестве контейнера и объект для управления событиями.

- CatalogCard: Этот компонент наследуется от базового класса Карты и отображает карточку товара на главной странице. Он также управляет данными о товаре и действиями с ним. Конструктор принимает элемент DOM в качестве контейнера и объект для управления событиями.

- PreviewCard: Этот компонент, наследующийся от класса CatalogCard, отображает карточку товара в модальном окне после клика на карточку на главной странице. Он содержит поля для отображения описания товара и кнопки "купить" или "удалить". Методы позволяют устанавливать описание товара, проверять валидность карточки и управлять состоянием кнопки.

- BasketCard: Этот компонент, наследующийся от класса Card, отображает отдельный товар в корзине. При клике по кнопке удаления генерируется событие 'basket:item-changed'. Он содержит поле для отображения порядкового номера товара в корзине и кнопку удаления товара.

- BasketView: Этот компонент, наследующийся от базового класса View, отвечает за отображение контейнера с корзиной. Кнопка "оформить" активна, если в корзине есть товары. При клике на кнопку вызывается метод объекта OrderBuilder для установки списка заказов.

- OrderForm: Этот компонент, наследующийся от базового класса Form, отображает форму заказа (адрес, способ оплаты). Пользователь может выбрать способ оплаты ("онлайн" или "при получении") и ввести адрес. Методы позволяют получить выбранный способ оплаты и введенный адрес, а также управлять валидностью формы.

- ContactForm: Этот компонент, наследующийся от базового класса Form, отображает форму контактов (email, телефон). Пользователь может ввести свой email и номер телефона. Методы позволяют получить введенные контактные данные.

- Success: Этот компонент, наследующийся от класса View, представляет собой окно для отображения информации об успешной покупке. Он содержит кнопку "за новыми покупками!". При клике на кнопку модальное окно закрывается, а корзина очищается. Метод позволяет установить количество потраченных средств.
