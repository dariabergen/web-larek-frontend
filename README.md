# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack
Для сборки используется Webpack.

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```
или

```
yarn
yarn start
```

## Сборка

```
npm run build
```
или

```
yarn build
```
## Архитектура

Приложение организовано в соответствии с паттерном MVP, где данные, представление и презентер взаимодействуют между собой через событийно-ориентированный подход.

- Слой модели занимается работой с данными - их получением, обработкой и изменением.

- Слой представления отвечает за отображение данных и работу с интерфейсом приложения.

- Презентер (реализован в файле index.ts) соединяет модель и представление, обеспечивая эффективное взаимодействие между ними.

Основное взаимодействие в приложении начинается с index.ts, который выполняет поиск шаблонов разметки, создает экземпляры классов для работы с бэкендом и EventEmitter. EventEmitter реализует паттерн "наблюдатель", позволяя компонентам подписываться на события и реагировать на них.

Далее приложение, используя цепочку событий, обрабатывает действия пользователя на странице через EventEmitter, обеспечивая взаимодействие с различными компонентами интерфейса приложения - формами, модальными окнами, корзиной.

В случае успешного сценария использования, информация о карточках в корзине, контактных данных пользователя, платежной информации и общей стоимости заказа отправляется на сервер с помощью POST-запроса, обрабатываемого экземпляром класса IproductsAPI.

Это позволяет эффективно управлять состоянием приложения, обеспечивать плавное взаимодействие пользователя с интерфейсом и передавать необходимую информацию между компонентами приложения.

## Базовый код

- Api: Класс для работы с низкоуровневыми операциями API. Он имеет методы для отправки GET и POST запросов на сервер, а также для обработки ответов.
- EventEmitter: Этот класс реализует паттерн "Наблюдатель" и позволяет подписываться на события и уведомлять подписчиков о наступлении событий.
- Model: Это базовый абстрактный класс для всех классов моделей данных. Он использует EventEmitter для уведомления о изменениях в данных.
- Component: Этот класс представляет базовый абстрактный класс для всех классов отображений в пользовательском интерфейсе. Он предоставляет методы для управления HTML-элементами и отображения данных.


## Модель данных:

Класс AppData представляет собой хранилище данных для приложения.
Он содержит информацию о следующих данных:
- cardList: Список карточек товаров.
- basket: Список идентификаторов товаров в корзине.
- order: Информация о текущем заказе.
- preview: Идентификатор карточки товара, который находится в предпросмотре.
- formErrors: Ошибки, возникшие при заполнении форм.
Методы:
- get cardList(): Возвращает список карточек товаров.
- set cardList(cardList: ICard[]): Устанавливает список карточек товаров и генерирует событие изменения списка.
- get basket(): Возвращает список идентификаторов товаров в корзине.
- addToBasket(id: string): Добавляет товар в корзину.
- setToBasket(cardIds: string[]): Устанавливает список товаров в корзину и генерирует событие изменения корзины.
- deleteCardToBasket(id: string): Удаляет товар из корзины.
- get order(): Возвращает информацию о текущем заказе.
- setOrder(order: IOrder | null): Устанавливает информацию о текущем заказе и генерирует событие изменения заказа.
- get preview(): Возвращает идентификатор карточки товара, который находится в предпросмотре.


## Компоненты представления:

- Класс Page отвечает за отображение главной страницы приложения.
Он содержит элементы DOM для отображения количества товаров в корзине, списка карточек товаров, а также кнопки корзины.
Методы:
set counter(value: number | null): Обновляет счетчик товаров в корзине.
set catalog(items: HTMLElement[]): Отображает список карточек товаров.
set locked(value: boolean): Блокирует/разблокирует прокрутку страницы.

- Класс Card представляет собой карточку товара.
Он содержит элементы DOM для отображения категории, названия, изображения и цены товара.
Методы:
set category(value: string): Отображает категорию товара.
set title(value: string): Отображает название товара.
set image(src: string): Отображает изображение товара.
set price(value: number): Отображает цену товара.

- Класс CardPreview наследует от класса Card и представляет собой карточку товара в превью.
Он содержит элементы DOM для отображения описания, цены и кнопки действия (например, "Добавить в корзину").
Методы:
set description(value: string): Отображает описание товара.
set price(value: number | null): Отображает цену товара.
onClick(): Вызывает метод onClick объекта actions, если он существует.
render(): Добавляет обработчик события click к кнопке действия и вызывает метод render родительского класса.

- Класс CardBasket наследует от класса Card и представляет собой карточку товара в корзине.
Он содержит элементы DOM для отображения индекса, названия, цены и кнопки действия (например, "Удалить").
Методы:
set index(value: number): Отображает индекс товара в корзине.
set title(value: string): Отображает название товара.
set price(value: number): Отображает цену товара.
onClick(): Вызывает метод onClick объекта actions, если он существует.
render(): Добавляет обработчик события click к кнопке действия и вызывает метод render родительского класса.

- Класс Form представляет собой компонент для работы с формами.
Он содержит элементы DOM для кнопки отправки формы и отображения ошибок.
Методы:
onInputChange(): Обработчик события ввода, который используется для проверки формы и обновления ее состояния.
set valid(value: boolean): Контролирует активность кнопки отправки формы в зависимости от ее валидности.
set errors(errors: string[]): Отображает список ошибок валидации формы.
render(): Отображает состояние формы.

- Класс Order наследует от класса Form и представляет собой компонент для модального окна оформления заказа.
Он содержит элементы DOM для выбора способа оплаты и указания адреса доставки.
Методы:
set payment(name: string): Устанавливает выбранный способ оплаты.
set address(address: string): Устанавливает адрес доставки.
render(): Отображает модальное окно оформления заказа и добавляет обработчик событий к кнопкам.

- Класс Contacts наследует от класса Form и представляет собой компонент для модального окна контактной информации.
Он содержит элементы DOM для ввода номера телефона и адреса электронной почты.
Методы:
onInputChange(): Обработчик события ввода, который используется для обновления значений свойств phone и email.
set phone(phone: string): Устанавливает значение свойства phone.
set email(email: string): Устанавливает значение свойства email.

- Класс Success представляет собой компонент для модального окна успешного заказа.
Он содержит элементы DOM для отображения информации о заказе и кнопки закрытия.
Методы:
set total(value: number): Отображает общую сумму заказа.
onCloseClick(): Вызывает метод onClick объекта actions, если он существует, при нажатии кнопки закрытия.

- Класс Modal представляет собой компонент для работы с модальным окном.
Он содержит элементы DOM для кнопки закрытия и контента модального окна.
Методы:
set content(content: HTMLElement): Определяет контент, который будет отображаться в модальном окне.
open(): Открывает модальное окно.
close(): Закрывает модальное окно.
**render()

## Связь с сервером
Класс IproductApi наследует от класса Api и реализует интерфейс IproductApi.
Он предоставляет методы для взаимодействия с веб-API Larek.
Методы:
getCardList(): Получает список всех карточек с сервера.
getCardItem(id: string): Получает данные карточки по ее ID.
orderCard(order: IOrder): Оформляет заказ на карточку.